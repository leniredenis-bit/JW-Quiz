<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="description" content="Teste seus conhecimentos bíblicos e desafie seus amigos!"/>
    <meta name="theme-color" content="#007bff"/>
    <title>JW Quiz</title>
    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="CSS/style.css">
</head>
<body>

    <div id="app-container" role="application" aria-label="JW Quiz">

        <!-- TELA INICIAL -->
        <section id="home-view" class="view active" role="main" aria-labelledby="home-title">
            <header class="app-header">
                <h1 id="home-title">JW Quiz</h1>
            </header>

            <main class="menu" role="navigation" aria-label="Menu principal">
                <div class="buttons-row">
                    <button id="start-quick-quiz-btn" class="btn btn-primary" aria-label="Iniciar quiz rápido com perguntas aleatórias">▶️ Iniciar Quiz Rápido</button>
                    <button id="start-study-mode-btn" class="btn btn-secondary" aria-label="Iniciar modo estudo sem timer">📚 Modo Estudo</button>
                    <button id="start-multiplayer-btn" class="btn btn-secondary" aria-label="Entrar no modo partida em grupo online">🏆 Partida em Grupo</button>
                </div>

                <div class="buttons-row">
                    <button id="start-memory-game-btn" class="btn btn-secondary" aria-label="Jogar jogo da memória com animais">🧠 Teste sem memória</button>
                </div>

                <div class="stats-row">
                    <button id="show-stats-btn" class="btn btn-link" aria-label="Ver minhas estatísticas pessoais">📊 Minhas Estatísticas</button>
                </div>

                <div class="filter-section" role="region" aria-labelledby="theme-title">
                    <h2 id="theme-title">Quiz por Tema</h2>
                    <div id="tags-container" class="tags-container" role="group" aria-label="Selecionar tema do quiz">
                        <!-- As tags serão inseridas aqui pelo JavaScript -->
                    </div>

                    <!-- container para widget de tags (compatível com instruções externas) -->
                    <div id="tags-root" class="tags-container" aria-hidden="true" style="display:none"></div>
                </div>

                <div class="filter-section" role="region" aria-labelledby="difficulty-title">
                    <h2 id="difficulty-title">Quiz por Dificuldade</h2>
                    <div id="difficulty-container" class="difficulty-container" role="group" aria-label="Selecionar nível de dificuldade">
                        <!-- Níveis de dificuldade -->
                    </div>
                </div>

                <footer>
                    <button id="manage-content-btn" class="btn btn-link" aria-label="Acessar painel de gerenciamento de perguntas" disabled>Gerenciar Perguntas</button>
                    <button id="theme-toggle" class="theme-toggle-btn" aria-label="Alternar tema escuro/claro">modo escuro</button>
                </footer>
            </main>
        </section>

        <!-- TELA DO QUIZ -->
        <section id="quiz-view" class="view" role="main" aria-labelledby="quiz-title" aria-live="polite">
            <div class="quiz-card" role="region" aria-label="Pergunta do quiz">
                <div class="quiz-header">
                    <div id="quiz-progress" class="quiz-progress" aria-label="Progresso do quiz">Pergunta 1 de 10</div>
                    <div id="quiz-timer" class="quiz-timer" role="timer" aria-label="Tempo restante">
                        <div id="timer-bar" class="timer-bar" aria-hidden="true"></div>
                        <div id="timer-text" class="timer-text" aria-live="assertive">--s</div>
                    </div>
                </div>

                <div id="question-area" class="question-area">
                    <h2 id="question-text">Pergunta aparece aqui</h2>
                </div>

                <div id="options-container" class="options-container" role="radiogroup" aria-labelledby="question-text">
                    <!-- Botões de opção gerados dinamicamente -->
                </div>

                <div id="reference-area" class="reference-area hidden" role="region" aria-labelledby="reference-title">
                    <div class="reference-title" id="reference-title">Resposta correta:</div>
                    <div id="correct-answer" class="correct-answer" aria-live="polite"></div>
                    <div class="reference-title">Referência:</div>
                    <div id="reference-text" class="reference-text"></div>
                    <div class="reference-title">Texto Bíblico (TNM):</div>
                    <div id="biblical-text" class="biblical-text"></div>
                    <div id="auto-next-counter" class="auto-next-counter" style="display: none;">
                        <span>Próxima pergunta em </span>
                        <span id="auto-next-text" class="auto-next-text">10</span>
                        <span> segundos...</span>
                    </div>
                </div>

                <div class="quiz-footer">
                    <button id="next-btn" class="btn btn-primary" disabled aria-label="Ir para próxima pergunta">Próxima</button>
                    <button id="quit-btn" class="btn btn-secondary" aria-label="Sair do quiz e voltar ao menu">Sair</button>
                </div>
            </div>
        </section>

        <!-- TELA DE PARTIDA EM GRUPO -->
        <section id="group-view" class="view" role="main" aria-labelledby="group-title">
            <div class="quiz-card">
                <header class="stats-header">
                    <h2 id="group-title">🏆 Partida em Grupo</h2>
                    <button id="back-from-group" class="btn btn-link" aria-label="Voltar ao menu principal">← Voltar</button>
                </header>

                <div class="group-content">
                    <!-- Menu Inicial -->
                    <div id="group-menu" class="menu">
                        <div class="buttons-row">
                            <button id="create-group-btn" class="btn btn-primary">🎯 Criar Partida</button>
                            <button id="join-group-btn" class="btn btn-secondary">🔗 Entrar na Partida</button>
                        </div>
                    </div>

                    <!-- Criar Partida -->
                    <div id="create-group" class="filter-section" style="display: none;">
                        <h3>🎯 Criar Nova Partida</h3>
                        <div class="group-form">
                            <div class="form-group">
                                <label for="group-name">Nome da Partida:</label>
                                <input type="text" id="group-name" placeholder="Ex: Quiz Bíblico da Família" maxlength="30" style="width: 100%; padding: 0.5rem; margin: 0.5rem 0; border-radius: 8px; border: 1px solid #ddd;">
                            </div>
                            <div class="form-group">
                                <label for="host-name">Seu Nome:</label>
                                <input type="text" id="host-name" placeholder="Digite seu nome" maxlength="20" style="width: 100%; padding: 0.5rem; margin: 0.5rem 0; border-radius: 8px; border: 1px solid #ddd;">
                            </div>
                            <div class="buttons-row" style="margin-top: 1rem;">
                                <button id="confirm-create-group" class="btn btn-primary">🚀 Criar Partida</button>
                                <button id="cancel-create-group" class="btn btn-link">Cancelar</button>
                            </div>
                        </div>
                    </div>

                    <!-- Entrar na Partida -->
                    <div id="join-group" class="filter-section" style="display: none;">
                        <h3>🔗 Entrar na Partida</h3>
                        <div class="group-form">
                            <div class="form-group">
                                <label for="group-code">Código da Partida:</label>
                                <input type="text" id="group-code" placeholder="Cole o código aqui" maxlength="8" style="width: 100%; padding: 0.5rem; margin: 0.5rem 0; border-radius: 8px; border: 1px solid #ddd; text-transform: uppercase;">
                            </div>
                            <div class="form-group">
                                <label for="player-name">Seu Nome:</label>
                                <input type="text" id="player-name" placeholder="Digite seu nome" maxlength="20" style="width: 100%; padding: 0.5rem; margin: 0.5rem 0; border-radius: 8px; border: 1px solid #ddd;">
                            </div>
                            <div class="buttons-row" style="margin-top: 1rem;">
                                <button id="confirm-join-group" class="btn btn-primary">🎮 Entrar</button>
                                <button id="cancel-join-group" class="btn btn-link">Cancelar</button>
                            </div>
                        </div>
                    </div>

                    <!-- Sala de Espera (Anfitrião) -->
                    <div id="group-lobby-host" class="filter-section" style="display: none;">
                        <h3 id="lobby-host-title">🎯 Sala de Espera</h3>
                        <div class="group-info">
                            <div class="group-code-display">
                                <span class="code-label">Código da Partida:</span>
                                <span id="group-code-display" class="code-value">XXXX-XXXX</span>
                                <button id="copy-code-btn" class="btn btn-link" style="font-size: 0.8rem;">📋 Copiar</button>
                            </div>
                            <div class="group-link-display" style="margin-top: 1rem;">
                                <span class="link-label">Link para Convidados:</span>
                                <div class="link-container">
                                    <input type="text" id="group-link-display" readonly style="width: 100%; padding: 0.5rem; border-radius: 8px; border: 1px solid #ddd; background: var(--bg-secondary);">
                                    <button id="copy-link-btn" class="btn btn-link" style="margin-left: 0.5rem;">📋 Copiar</button>
                                </div>
                            </div>
                        </div>

                        <div class="players-section" style="margin-top: 2rem;">
                            <h4>👥 Jogadores ({!!window.groupPlayers ? window.groupPlayers.length : 0!!}/10)</h4>
                            <div id="players-list-host" class="players-list">
                                <!-- Jogadores serão listados aqui -->
                            </div>
                        </div>

                        <div class="lobby-actions" style="margin-top: 2rem;">
                            <button id="start-group-game" class="btn btn-primary" disabled>▶️ Iniciar Partida</button>
                            <button id="cancel-group-lobby" class="btn btn-link">❌ Cancelar Partida</button>
                        </div>
                    </div>

                    <!-- Sala de Espera (Participante) -->
                    <div id="group-lobby-player" class="filter-section" style="display: none;">
                        <h3 id="lobby-player-title">🎮 Aguardando Início</h3>
                        <div class="waiting-info">
                            <div class="waiting-message">
                                <p>🎯 Aguardando o anfitrião iniciar a partida...</p>
                                <div class="waiting-spinner" style="margin: 1rem 0;">
                                    <div class="spinner"></div>
                                </div>
                            </div>
                            <div class="players-section" style="margin-top: 2rem;">
                                <h4>👥 Jogadores na Partida</h4>
                                <div id="players-list-player" class="players-list">
                                    <!-- Jogadores serão listados aqui -->
                                </div>
                            </div>
                        </div>
                        <div class="lobby-actions" style="margin-top: 2rem;">
                            <button id="leave-group-lobby" class="btn btn-link">🚪 Sair da Partida</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- TELA DO JOGO DA MEMÓRIA -->
        <section id="memory-view" class="view" role="main" aria-labelledby="memory-title">
            <div class="quiz-card">
                <header class="stats-header">
                    <h2 id="memory-title">🧠 Teste sem memória</h2>
                    <button id="back-from-memory" class="btn btn-link" aria-label="Voltar ao menu principal">← Voltar</button>
                </header>

                <div class="memory-content">
                    <h1>Teste sem memória</h1>

                    <div class="controls">
                        <div class="control-group">
                            <label for="player-count">Jogadores (1-4):</label>
                            <input type="number" id="player-count" value="1" min="1" max="4">
                        </div>
                        <div class="control-group">
                            <label for="theme-select">Escolha o Tema:</label>
                            <select id="theme-select">
                                <option value="animais">Animais</option>
                                <option value="frutas">Frutas</option>
                                <option value="transportes">Transportes</option>
                            </select>
                        </div>
                        <button id="start-game">Iniciar / Reiniciar Jogo</button>
                    </div>

                    <div id="status-display">
                        <!-- O status do jogo (turno do jogador, placar) será inserido aqui pelo JavaScript -->
                    </div>

                    <div class="game-container">
                        <section id="game-board" class="game-board">
                            <!-- As cartas serão geradas aqui pelo JavaScript -->
                        </section>
                    </div>
                </div>
            </div>
        </section>

        <!-- TELA DE ANALYTICS (Desenvolvedor) -->
        <section id="analytics-view" class="view" role="main" aria-labelledby="analytics-title">
            <div class="quiz-card">
                <header class="stats-header">
                    <h2 id="analytics-title">📊 Analytics (Desenvolvedor)</h2>
                    <button id="back-from-analytics" class="btn btn-link" aria-label="Voltar ao menu principal">← Voltar</button>
                </header>

                <div class="stats-content">
                    <!-- Métricas Gerais -->
                    <div class="stats-section">
                        <h3>👥 Usuários e Sessões</h3>
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-value" id="analytics-users">0</div>
                                <div class="stat-label">Usuários Únicos</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="analytics-sessions">0</div>
                                <div class="stat-label">Total de Sessões</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="analytics-avg-session">0s</div>
                                <div class="stat-label">Tempo Médio/Sessão</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="analytics-completion">0%</div>
                                <div class="stat-label">Taxa de Conclusão</div>
                            </div>
                        </div>
                    </div>

                    <!-- Atividade -->
                    <div class="stats-section">
                        <h3>🎮 Atividade</h3>
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-value" id="analytics-quizzes">0</div>
                                <div class="stat-label">Quizzes Iniciados</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="analytics-questions">0</div>
                                <div class="stat-label">Perguntas Respondidas</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="analytics-light-theme">0</div>
                                <div class="stat-label">Usam Tema Claro</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="analytics-dark-theme">0</div>
                                <div class="stat-label">Usam Tema Escuro</div>
                            </div>
                        </div>
                    </div>

                    <!-- Dispositivos -->
                    <div class="stats-section">
                        <h3>📱 Dispositivos</h3>
                        <div id="device-stats" class="category-stats">
                            <!-- Será preenchido dinamicamente -->
                        </div>
                    </div>

                    <!-- Uso por Hora -->
                    <div class="stats-section">
                        <h3>🕐 Uso por Hora do Dia</h3>
                        <div class="hourly-chart" id="hourly-chart">
                            <!-- Será preenchido dinamicamente -->
                        </div>
                    </div>

                    <!-- Ações do Desenvolvedor -->
                    <div class="stats-actions">
                        <button id="export-analytics" class="btn btn-primary">📤 Exportar Dados Completos</button>
                        <button id="clear-analytics" class="btn btn-secondary">🗑️ Limpar Analytics</button>
                    </div>
                </div>
            </div>
        </section>

        <!-- TELA DE ESTATÍSTICAS -->
        <section id="stats-view" class="view" role="main" aria-labelledby="stats-title">
            <div class="quiz-card">
                <header class="stats-header">
                    <h2 id="stats-title">📊 Minhas Estatísticas</h2>
                    <button id="back-from-stats" class="btn btn-link" aria-label="Voltar ao menu principal">← Voltar</button>
                </header>

                <div class="stats-content">
                    <!-- Estatísticas Gerais -->
                    <div class="stats-section">
                        <h3>🎯 Estatísticas Gerais</h3>
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-value" id="total-games">0</div>
                                <div class="stat-label">Jogos Jogados</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="total-questions">0</div>
                                <div class="stat-label">Perguntas Respondidas</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="accuracy-rate">0%</div>
                                <div class="stat-label">Taxa de Acerto</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="best-streak">0</div>
                                <div class="stat-label">Melhor Sequência</div>
                            </div>
                        </div>
                    </div>

                    <!-- Estatísticas de Tempo -->
                    <div class="stats-section">
                        <h3>⏱️ Estatísticas de Tempo</h3>
                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-value" id="avg-time">0s</div>
                                <div class="stat-label">Tempo Médio/Pergunta</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="total-time">0min</div>
                                <div class="stat-label">Tempo Total Jogado</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="fastest-answer">0s</div>
                                <div class="stat-label">Resposta Mais Rápida</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-value" id="study-sessions">0</div>
                                <div class="stat-label">Sessões de Estudo</div>
                            </div>
                        </div>
                    </div>

                    <!-- Estatísticas por Categoria -->
                    <div class="stats-section">
                        <h3>📂 Desempenho por Categoria</h3>
                        <div id="category-stats" class="category-stats">
                            <!-- Será preenchido dinamicamente -->
                        </div>
                    </div>

                    <!-- Estatísticas por Dificuldade -->
                    <div class="stats-section">
                        <h3>🎚️ Desempenho por Dificuldade</h3>
                        <div class="difficulty-stats">
                            <div class="difficulty-bar">
                                <span class="difficulty-label">Fácil</span>
                                <div class="progress-bar">
                                    <div class="progress-fill easy-fill" id="easy-progress" style="width: 0%"></div>
                                </div>
                                <span class="difficulty-rate" id="easy-rate">0%</span>
                            </div>
                            <div class="difficulty-bar">
                                <span class="difficulty-label">Médio</span>
                                <div class="progress-bar">
                                    <div class="progress-fill medium-fill" id="medium-progress" style="width: 0%"></div>
                                </div>
                                <span class="difficulty-rate" id="medium-rate">0%</span>
                            </div>
                            <div class="difficulty-bar">
                                <span class="difficulty-label">Difícil</span>
                                <div class="progress-bar">
                                    <div class="progress-fill hard-fill" id="hard-progress" style="width: 0%"></div>
                                </div>
                                <span class="difficulty-rate" id="hard-rate">0%</span>
                            </div>
                        </div>
                    </div>

                    <!-- Ações -->
                    <div class="stats-actions">
                        <button id="reset-stats" class="btn btn-secondary">🔄 Resetar Estatísticas</button>
                        <button id="export-stats" class="btn btn-link">📤 Exportar Dados</button>
                    </div>
                </div>
            </div>
        </section>

    </div>

    <script src="JS/quiz.js"></script>
    <script src="JS/main.js"></script>
    <script src="JS/unregister-sw.js"></script>
    <script src="JS/debug.js"></script>
    <script src="JS/script.js"></script>
</body>
</html>